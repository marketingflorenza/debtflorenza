<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ - Florenza Clinic</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <style>
        /* --- CSS STYLES --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', 'Tahoma', 'Apple Color Emoji', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        .container { max-width: 1400px; margin: 0 auto; }
        
        .card {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
            margin-bottom: 25px;
            border: 1px solid #fff;
        }

        /* Header */
        .header { text-align: center; border-bottom: 4px solid #764ba2; }
        .header h1 { color: #2c3e50; font-size: 2rem; margin-bottom: 5px; }
        .header p { color: #7f8c8d; }

        /* Upload & Filter */
        .upload-section { display: flex; flex-direction: column; align-items: center; gap: 15px; }
        input[type="file"] {
            padding: 10px; border: 2px dashed #3498db; border-radius: 10px; width: 100%; max-width: 400px;
        }
        
        .filter-container {
            display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; align-items: center;
            padding-top: 15px; border-top: 1px solid #eee; width: 100%;
        }
        
        button {
            padding: 10px 20px; border-radius: 8px; border: none; cursor: pointer;
            font-weight: 600; transition: 0.3s; color: white;
        }
        #processFileBtn { background: #3498db; }
        #filterBtn { background: #27ae60; }
        #resetBtn { background: #e67e22; }
        #exportMainBtn { background: #2c3e50; }
        button:hover:not(:disabled) { opacity: 0.8; transform: translateY(-1px); }
        button:disabled { background: #bdc3c7; cursor: not-allowed; }

        /* Stats Grid */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; }
        .stat-card {
            background: white; padding: 20px; border-radius: 12px; text-align: center;
            border-left: 5px solid #eee; transition: 0.3s;
        }
        .stat-card:hover { transform: scale(1.02); }
        .stat-card.total { border-left-color: #9b59b6; }
        .stat-card.overdue { border-left-color: #e74c3c; }
        .stat-card.current { border-left-color: #27ae60; }
        .stat-card.customers { border-left-color: #3498db; }
        .stat-value { font-size: 1.5rem; font-weight: 800; margin: 5px 0; }
        .stat-label { font-size: 0.9rem; color: #7f8c8d; }

        /* Charts */
        .charts-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }

        /* Table */
        .table-container { overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; background: white; }
        th, td { padding: 12px 15px; text-align: left; border-bottom: 1px solid #eee; }
        th { background: #f8f9fa; color: #2c3e50; position: sticky; top: 0; }
        th.sortable { cursor: pointer; }
        th.sortable:hover { background: #edf2f7; }
        
        tr.clickable-row:hover { background: #f1f5f9; cursor: pointer; }
        .status { padding: 4px 8px; border-radius: 20px; font-size: 0.75rem; font-weight: bold; }
        .status.overdue { background: #ffdce0; color: #af1e2c; }
        .status.current { background: #dcfce7; color: #15803d; }
        .status.prepaid { background: #dbeafe; color: #1e40af; }

        /* Modal */
        .modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); }
        .modal-content { background: white; margin: 5% auto; padding: 25px; border-radius: 15px; width: 80%; max-width: 800px; position: relative; }
        .close { position: absolute; right: 20px; top: 15px; font-size: 24px; cursor: pointer; }

        @media (max-width: 768px) { .charts-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

<div class="container">
    <div class="header card">
        <h1>üìä Dashboard ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ</h1>
        <p>Florenza Clinic | ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</p>
    </div>

    <div class="card upload-section">
        <h3>‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå (.xlsx ‡∏´‡∏£‡∏∑‡∏≠ .csv)</h3>
        <input type="file" id="fileInput" accept=".xlsx, .xls, .csv">
        <button id="processFileBtn">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>

        <div class="filter-container">
            <div>
                ‡πÄ‡∏£‡∏¥‡πà‡∏°: <input type="date" id="startDate" disabled>
                ‡∏ñ‡∏∂‡∏á: <input type="date" id="endDate" disabled>
            </div>
            <button id="filterBtn" disabled>üîç ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
            <button id="resetBtn" disabled>üîÑ ‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á</button>
            <button id="exportMainBtn" disabled>üì• ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å Excel</button>
        </div>
    </div>

    <div class="stats-grid">
        <div class="stat-card total">
            <div class="stat-label">‡∏¢‡∏≠‡∏î‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏£‡∏ß‡∏°</div>
            <div class="stat-value" id="totalAmount">0</div>
            <div class="stat-label">‡∏ö‡∏≤‡∏ó</div>
        </div>
        <div class="stat-card overdue">
            <div class="stat-label">‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î</div>
            <div class="stat-value" id="overdueAmount" style="color: #e74c3c;">0</div>
            <div class="stat-label">‡∏ö‡∏≤‡∏ó</div>
        </div>
        <div class="stat-card current">
            <div class="stat-label">‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</div>
            <div class="stat-value" id="currentAmount" style="color: #27ae60;">0</div>
            <div class="stat-label">‡∏ö‡∏≤‡∏ó</div>
        </div>
        <div class="stat-card customers">
            <div class="stat-label">‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
            <div class="stat-value" id="totalCustomers">0</div>
            <div class="stat-label">‡∏£‡∏≤‡∏¢</div>
        </div>
    </div>

    <div class="charts-grid" style="margin-top: 25px;">
        <div class="card">
            <h3 style="text-align: center; margin-bottom: 15px;">‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ</h3>
            <canvas id="statusChart"></canvas>
        </div>
        <div class="card">
            <h3 style="text-align: center; margin-bottom: 15px;">‡∏≠‡∏≤‡∏¢‡∏∏‡∏´‡∏ô‡∏µ‡πâ (Aging Report)</h3>
            <canvas id="agingChart"></canvas>
        </div>
    </div>

    <div class="card table-container">
        <h3>üìã ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ</h3>
        <p style="font-size: 0.8rem; color: #777; margin-bottom: 10px;">* ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏¢‡πà‡∏≠‡∏¢</p>
        <table>
            <thead>
                <tr>
                    <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                    <th>‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</th>
                    <th>‡πÄ‡∏•‡∏Ç HN</th>
                    <th>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</th>
                    <th class="sortable" id="sortAmount">‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó) ‚áÖ</th>
                    <th class="sortable" id="sortDate">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î ‚áÖ</th>
                    <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                </tr>
            </thead>
            <tbody id="debtTable">
                <tr><td colspan="7" style="text-align: center; padding: 40px;">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>
            </tbody>
        </table>
    </div>
</div>

<div id="detailsModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2 id="modalTitle">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</h2>
        <hr style="margin: 15px 0;">
        <div id="modalBody" class="table-container"></div>
    </div>
</div>

<script>
    // --- Global States ---
    let allCleanData = [];
    let currentDisplayData = [];
    let customerDetails = {};
    let statusChart, agingChart;
    let sortDir = { amount: 'desc', date: 'desc' };

    // --- DOM Elements ---
    const fileInput = document.getElementById('fileInput');
    const processBtn = document.getElementById('processFileBtn');
    const debtTableBody = document.getElementById('debtTable');
    const filterBtn = document.getElementById('filterBtn');
    const resetBtn = document.getElementById('resetBtn');
    const exportBtn = document.getElementById('exportMainBtn');
    const startDateInput = document.getElementById('startDate');
    const endDateInput = document.getElementById('endDate');

    // --- Initialize Charts ---
    function initCharts() {
        const sCtx = document.getElementById('statusChart').getContext('2d');
        statusChart = new Chart(sCtx, {
            type: 'doughnut',
            data: {
                labels: ['‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î', '‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô', '‡∏ä‡∏≥‡∏£‡∏∞‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤'],
                datasets: [{ data: [0, 0, 0], backgroundColor: ['#e74c3c', '#27ae60', '#3498db'] }]
            },
            options: { plugins: { legend: { position: 'bottom' } } }
        });

        const aCtx = document.getElementById('agingChart').getContext('2d');
        agingChart = new Chart(aCtx, {
            type: 'bar',
            data: {
                labels: ['0-30 ‡∏ß‡∏±‡∏ô', '31-60 ‡∏ß‡∏±‡∏ô', '61-90 ‡∏ß‡∏±‡∏ô', '91+ ‡∏ß‡∏±‡∏ô'],
                datasets: [{ label: '‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó)', data: [0,0,0,0], backgroundColor: '#9b59b6' }]
            }
        });
    }
    initCharts();

    // --- Core Logic ---
    processBtn.onclick = () => {
        const file = fileInput.files[0];
        if (!file) return alert('‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö');

        const reader = new FileReader();
        const ext = file.name.split('.').pop().toLowerCase();

        reader.onload = (e) => {
            let rows = [];
            if (ext === 'csv') {
                rows = e.target.result.split('\n').map(r => r.split(','));
            } else {
                const data = new Uint8Array(e.target.result);
                const wb = XLSX.read(data, { type: 'array', raw: true });
                rows = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]], { header: 1 });
            }
            parseData(rows);
        };

        if (ext === 'csv') reader.readAsText(file);
        else reader.readAsArrayBuffer(file);
    };

    function parseData(rows) {
        allCleanData = [];
        customerDetails = {};
        let currentCust = null;
        let tempItems = [];
        let lastDate = null;

        rows.forEach(row => {
            if (!row || row.length < 5) return;

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏ñ‡∏ß‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (‡∏°‡∏±‡∏Å‡∏°‡∏µ / ‡∏Ñ‡∏±‡πà‡∏ô)
            if (row[1] && String(row[1]).includes('/')) {
                const parts = row[1].split('/');
                currentCust = { name: parts[0].trim(), hn: parts[1].trim(), phone: parts[2] ? parts[2].trim() : '' };
                if (!customerDetails[currentCust.name]) {
                    customerDetails[currentCust.name] = { ...currentCust, transactions: [] };
                }
            }

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏ñ‡∏ß‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
            const transDate = parseDate(row[5]);
            if (row[3] && transDate) {
                const balance = parseFloat(String(row[10]).replace(/,/g, '')) || 0;
                customerDetails[currentCust.name].transactions.push({
                    date: transDate, item: row[3], receipt: row[4], balance: balance
                });
                if (balance !== 0) tempItems.push(row[3]);
                if (!lastDate || transDate > lastDate) lastDate = transDate;
            }

            // ‡πÅ‡∏ñ‡∏ß‡∏£‡∏ß‡∏°
            if (String(row[5]).trim() === '‡∏£‡∏ß‡∏°') {
                const totalBalance = parseFloat(String(row[10]).replace(/,/g, '')) || 0;
                if (totalBalance !== 0 && currentCust) {
                    allCleanData.push({
                        name: currentCust.name,
                        hn: currentCust.hn,
                        phone: currentCust.phone,
                        items: tempItems.join(', '),
                        amount: -totalBalance, // ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏Ñ‡πà‡∏≤‡∏Ñ‡πâ‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ß‡∏Å/‡∏•‡∏ö‡∏ï‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á
                        date: lastDate
                    });
                }
                tempItems = [];
                lastDate = null;
            }
        });

        currentDisplayData = [...allCleanData];
        renderDashboard();
        toggleControls(true);
    }

    function renderDashboard() {
        const today = new Date();
        let stats = { total: 0, overdue: 0, current: 0, prepaid: 0, aging: [0,0,0,0] };
        let html = '';

        currentDisplayData.forEach((d, i) => {
            const diffDays = Math.floor((today - d.date) / (1000 * 3600 * 24));
            let status = '‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô', sClass = 'current';

            if (d.amount > 0) {
                stats.total += d.amount;
                if (diffDays > 30) {
                    status = '‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î'; sClass = 'overdue'; stats.overdue += d.amount;
                    if (diffDays <= 60) stats.aging[1] += d.amount;
                    else if (diffDays <= 90) stats.aging[2] += d.amount;
                    else stats.aging[3] += d.amount;
                } else {
                    stats.current += d.amount;
                    stats.aging[0] += d.amount;
                }
            } else {
                status = '‡∏ä‡∏≥‡∏£‡∏∞‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤'; sClass = 'prepaid'; stats.prepaid += Math.abs(d.amount);
            }

            html += `
                <tr class="clickable-row" onclick="openDetails('${d.name}')">
                    <td>${i+1}</td>
                    <td>${d.name}</td>
                    <td>${d.hn}</td>
                    <td>${d.phone}</td>
                    <td style="font-weight:bold; color:${d.amount > 0 ? '#e74c3c':'#27ae60'}">${formatNum(d.amount)}</td>
                    <td>${d.date.toLocaleDateString('th-TH')}</td>
                    <td><span class="status ${sClass}">${status}</span></td>
                </tr>
            `;
        });

        debtTableBody.innerHTML = html || '<tr><td colspan="7" align="center">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>';
        
        // Update Stats & Charts
        document.getElementById('totalAmount').innerText = formatNum(stats.total);
        document.getElementById('overdueAmount').innerText = formatNum(stats.overdue);
        document.getElementById('currentAmount').innerText = formatNum(stats.current);
        document.getElementById('totalCustomers').innerText = currentDisplayData.length;

        statusChart.data.datasets[0].data = [stats.overdue, stats.current, stats.prepaid];
        statusChart.update();
        agingChart.data.datasets[0].data = stats.aging;
        agingChart.update();
    }

    // --- Utilities ---
    function parseDate(val) {
        if (!val) return null;
        if (typeof val === 'number') return new Date(Math.round((val - 25569) * 86400 * 1000));
        const s = String(val).trim();
        const m = s.match(/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/);
        if (m) return new Date(m[3], m[2]-1, m[1]);
        const d = new Date(s);
        return isNaN(d) ? null : d;
    }

    function formatNum(n) { return new Intl.NumberFormat('th-TH', { minimumFractionDigits: 2 }).format(n); }

    function toggleControls(enable) {
        [filterBtn, resetBtn, exportBtn, startDateInput, endDateInput].forEach(el => el.disabled = !enable);
    }

    // --- Actions ---
    filterBtn.onclick = () => {
        const start = startDateInput.valueAsDate;
        const end = endDateInput.valueAsDate;
        if (!start || !end) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà');
        end.setHours(23,59,59);

        currentDisplayData = allCleanData.filter(d => d.date >= start && d.date <= end);
        renderDashboard();
    };

    resetBtn.onclick = () => {
        startDateInput.value = ''; endDateInput.value = '';
        currentDisplayData = [...allCleanData];
        renderDashboard();
    };

    exportBtn.onclick = () => {
        const data = currentDisplayData.map((d, i) => ({
            '‡∏•‡∏≥‡∏î‡∏±‡∏ö': i+1, '‡∏ä‡∏∑‡πà‡∏≠': d.name, 'HN': d.hn, '‡πÇ‡∏ó‡∏£': d.phone, 
            '‡∏¢‡∏≠‡∏î‡∏Ñ‡πâ‡∏≤‡∏á': d.amount, '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î': d.date.toLocaleDateString('th-TH')
        }));
        const ws = XLSX.utils.json_to_sheet(data);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Debtors");
        XLSX.writeFile(wb, `Report_${new Date().toISOString().slice(0,10)}.xlsx`);
    };

    // Sorting
    document.getElementById('sortAmount').onclick = () => {
        sortDir.amount = sortDir.amount === 'asc' ? 'desc' : 'asc';
        currentDisplayData.sort((a,b) => sortDir.amount === 'asc' ? a.amount - b.amount : b.amount - a.amount);
        renderDashboard();
    };

    document.getElementById('sortDate').onclick = () => {
        sortDir.date = sortDir.date === 'asc' ? 'desc' : 'asc';
        currentDisplayData.sort((a,b) => sortDir.date === 'asc' ? a.date - b.date : b.date - a.date);
        renderDashboard();
    };

    // Modal Details
    const modal = document.getElementById('detailsModal');
    window.openDetails = (name) => {
        const det = customerDetails[name];
        document.getElementById('modalTitle').innerText = `‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥: ${name} (HN: ${det.hn})`;
        let h = `<table><thead><tr><th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th><th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th><th>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à</th><th>‡∏¢‡∏≠‡∏î‡∏Ñ‡πâ‡∏≤‡∏á</th></tr></thead><tbody>`;
        det.transactions.forEach(t => {
            h += `<tr><td>${t.date.toLocaleDateString('th-TH')}</td><td>${t.item}</td><td>${t.receipt}</td><td>${formatNum(t.balance)}</td></tr>`;
        });
        h += `</tbody></table>`;
        document.getElementById('modalBody').innerHTML = h;
        modal.style.display = 'block';
    };

    document.querySelector('.close').onclick = () => modal.style.display = 'none';
    window.onclick = (e) => { if(e.target == modal) modal.style.display = 'none'; };

</script>

</body>
</html>
